{% extends 'base.html' %}

{% block title %}é¦–é¡µ - æ ¡å›­å¹¿æ’­ç«™ç®¡ç†å¹³å°{% endblock %}

{% block content %}
<!-- ä¿¡æ¯æ  - Info Bar -->
<div class="info-bar">
    <div class="info-bar-item">
        <span class="info-bar-icon">ğŸ“…</span>
        <div>
            <div class="info-bar-label">ä»Šæ—¥æ—¥æœŸ</div>
            <div class="info-bar-value">{% now "Yå¹´mæœˆdæ—¥ l" %}</div>
        </div>
    </div>
    <div class="info-bar-item">
        <span class="info-bar-icon">â˜€ï¸</span>
        <div>
            <div class="info-bar-label">å¤©æ°”</div>
            <div class="info-bar-value">æ™´å¤© / 22Â°C</div>
        </div>
    </div>
    <div class="info-bar-item">
        <span class="info-bar-icon">ğŸ™ï¸</span>
        <div>
            <div class="info-bar-label">ä»Šæ—¥å½•éŸ³å®¤é¢„çº¦</div>
            <div class="info-bar-value">{{ today_bookings_count|default:0 }} ä¸ªæ—¶æ®µ</div>
        </div>
    </div>
</div>

<!-- æœ€æ–°å…¬å‘Š - Announcements Grid -->
<div class="front-page-announcements">
    <h2 class="front-page-title">â”â” ğŸ“‹ æœ€æ–°å…¬å‘Š â”â”</h2>
    
    {% if recent_announcements %}
        <div class="announcements-grid">
            {% for announcement in recent_announcements %}
                <div class="announcement-card {% if announcement.type == 'urgent' %}urgent{% endif %}">
                    <div class="announcement-card-header">
                        <span class="announcement-card-type">
                            {% if announcement.type == 'urgent' %}
                                ğŸš¨ ç´§æ€¥
                            {% elif announcement.type == 'activity' %}
                                ğŸ‰ æ´»åŠ¨
                            {% elif announcement.type == 'schedule_change' %}
                                ğŸ“… æ’ç­å˜æ›´
                            {% else %}
                                ğŸ“¢ é€šçŸ¥
                            {% endif %}
                        </span>
                        <span class="announcement-card-date">{{ announcement.publish_time|date:"m-d H:i" }}</span>
                    </div>
                    <h3 class="announcement-card-title">
                        <a href="/announcements/{{ announcement.id }}/">{{ announcement.title }}</a>
                    </h3>
                    <p class="announcement-card-preview">{{ announcement.content|truncatewords:20 }}</p>
                </div>
            {% endfor %}
        </div>
        <div class="section-footer">
            <a href="/announcements/">æŸ¥çœ‹å…¨éƒ¨å…¬å‘Š â†’</a>
        </div>
    {% else %}
        <div class="empty-message">
            <div class="empty-icon">ğŸ“­</div>
            <p>æš‚æ— å…¬å‘Š</p>
        </div>
    {% endif %}
</div>

<!-- ä¸¤æ å¸ƒå±€ - Today's Studio & Playlist -->
<div class="newspaper-columns-2">
    <!-- å·¦æ ï¼šä»Šæ—¥å½•éŸ³å®¤å®‰æ’ -->
    <div class="timeline-container">
        <h3 class="timeline-header">ğŸ™ï¸ ä»Šæ—¥å½•éŸ³å®¤å®‰æ’</h3>
        
        {% if today_bookings %}
            <!-- æ—¶é—´è½´åˆ»åº¦ -->
            <div class="timeline-scale">
                {% for hour in timeline_hours %}
                    <span class="timeline-hour">{{ hour }}:00</span>
                {% endfor %}
            </div>
            
            <!-- æ—¶é—´å—å¯è§†åŒ– -->
            <div class="timeline-bookings">
                {% for booking in today_bookings %}
                    <div class="booking-block {{ booking.status }}" 
                         style="left: {{ booking.start_offset }}%; width: {{ booking.width }}%;"
                         title="{{ booking.user.profile.real_name }} - {{ booking.purpose }}">
                        {% if booking.width > 15 %}
                            {{ booking.user.profile.real_name|truncatewords:1 }}
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
            
            <!-- é¢„çº¦åˆ—è¡¨è¯¦æƒ… -->
            <div class="booking-list">
                {% for booking in today_bookings %}
                    <div class="booking-item">
                        <span class="booking-time">{{ booking.start_time|time:"H:i" }}-{{ booking.end_time|time:"H:i" }}</span>
                        <div class="booking-info">
                            <div class="booking-user">{{ booking.user.profile.real_name }}</div>
                            <div class="booking-purpose">{{ booking.purpose }}</div>
                        </div>
                        <span class="booking-status {{ booking.status }}">
                            {% if booking.status == 'pending' %}å¾…ç¡®è®¤
                            {% elif booking.status == 'confirmed' %}å·²ç¡®è®¤
                            {% elif booking.status == 'completed' %}å·²å®Œæˆ
                            {% endif %}
                        </span>
                    </div>
                {% endfor %}
            </div>
            
            <div class="section-footer">
                <a href="/booking/">å®Œæ•´é¢„çº¦é¡µé¢ â†’</a>
            </div>
        {% else %}
            <div class="empty-message">
                <div class="empty-icon">ğŸ™ï¸</div>
                <p>ä»Šæ—¥æš‚æ— å½•éŸ³å®¤é¢„çº¦</p>
            </div>
            <div class="section-footer">
                <a href="/booking/create/">ç«‹å³é¢„çº¦ â†’</a>
            </div>
        {% endif %}
    </div>
    
    <!-- å³æ ï¼šä»Šæ—¥å¹¿æ’­æ­Œå• -->
    <div class="playlist-container">
        <h3 class="playlist-header">ğŸµ ä»Šæ—¥å¹¿æ’­æ­Œå•</h3>
        
        {% if today_songs %}
            <ol class="song-list">
                {% for song in today_songs %}
                    <li class="song-item">
                        <span class="song-number">{{ forloop.counter }}.</span>
                        <span class="song-title">{{ song.title }}</span>
                        {% if song.artist %}
                            <span class="song-artist">- {{ song.artist }}</span>
                        {% endif %}
                    </li>
                {% endfor %}
            </ol>
        {% else %}
            <div class="empty-message">
                <div class="empty-icon">ğŸµ</div>
                <p>ä»Šæ—¥æš‚æ— æ­Œå•å®‰æ’</p>
            </div>
        {% endif %}
        
        <!-- èŠ‚ç›®å®‰æ’ -->
        {% if today_programs %}
            <div class="programs-section">
                <h4 class="programs-title">ğŸ“» ä»Šæ—¥èŠ‚ç›®å®‰æ’</h4>
                {% for program in today_programs %}
                    <div class="program-item">
                        <div class="program-name">{{ program.name }}</div>
                        <div class="program-time">{{ program.time_slot }}</div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        
        <div class="section-footer">
            <a href="/broadcast/calendar/">æ’ç­æ—¥å† â†’</a>
        </div>
    </div>
</div>

<!-- å¿«é€Ÿå¯¼èˆª - Quick Navigation Sections -->
<h2 class="section-header">â”â” å„ç‰ˆå—å¯¼èˆª â”â”</h2>
<div class="newspaper-columns-4">
    <div class="section-card">
        <a href="/announcements/">
            <div class="section-card-icon">ğŸ“¢</div>
            <h3 class="section-card-title">å…¬å‘Šä¸“æ </h3>
            <p class="section-card-desc">æŸ¥çœ‹æœ€æ–°å…¬å‘Šå’Œé€šçŸ¥</p>
        </a>
    </div>

    <div class="section-card">
        <a href="/broadcast/calendar/">
            <div class="section-card-icon">ğŸ“…</div>
            <h3 class="section-card-title">æ’ç­ä¿¡æ¯</h3>
            <p class="section-card-desc">ç®¡ç†å¹¿æ’­ç«™æ—¥ç¨‹</p>
        </a>
    </div>

    <div class="section-card">
        <a href="/booking/">
            <div class="section-card-icon">ğŸ™ï¸</div>
            <h3 class="section-card-title">å½•éŸ³å®¤</h3>
            <p class="section-card-desc">é¢„çº¦ä½¿ç”¨å½•éŸ³å®¤</p>
        </a>
    </div>

    <div class="section-card">
        <a href="/himalaya/">
            <div class="section-card-icon">ğŸ§</div>
            <h3 class="section-card-title">å–œé©¬æ‹‰é›…</h3>
            <p class="section-card-desc">éŸ³é¢‘ä¸“è¾‘ç®¡ç†</p>
        </a>
    </div>
</div>
{% endblock %}
